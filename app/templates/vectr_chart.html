{% extends "base.html" %}

{% block title %}VECTR Prioritization: {{ project.project_name }}{% endblock %}

{% block content %}
<h2 class="text-center mb-4">VECTR Prioritization Chart for {{ project.project_name }}</h2>

<div class="top-right">
    <a href="{{ url_for('main.view_features', project_id=project.id_project) }}" class="btn btn-base btn-nav btn-sm">
        Features Overview
    </a>
</div>

<div class="text-center">
    <a href="{{ url_for('main.add_feature', project_id=project.id_project) }}" class="btn btn-base btn-primary-custom">
        + Add Feature
    </a>
</div>

<div id="chartData" style="display:none;">{{ chart_data | tojson }}</div>

<div class="card shadow p-4 mx-auto vectr-card">
    <canvas id="vectrChart"></canvas>
    <p class="text-center mt-3 text-muted">
        X-axis: Confidence | Y-axis: TtV | Bubble Size: ROI (The bigger the bubble, the higher the ROI)
    </p>
    <div class="d-flex justify-content-end mt-3">
        <a href="{{ url_for('main.vectr_chart_pdf', project_id=project.id_project) }}" class="btn btn-secondary-custom">
            Download PDF
        </a>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="{{ url_for('static', filename='js/feature_calculations.js') }}"></script>
<script src="{{ url_for('static', filename='js/vectr_chart.js') }}"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // 1. Data voorbereiden
        const chartData = JSON.parse(document.getElementById("chartData").textContent);
        const ctx = document.getElementById('vectrChart').getContext('2d'); 
        
        // 2. FUNCTIE AANROEP TOEVOEGEN OM DE GRAFIEK TE TEKENEN
        // Aanname dat deze functie globaal is gedefinieerd in vectr_chart.js
        if (typeof initVECTRChart === 'function') {
            initVECTRChart(ctx, chartData);
        } else {
            console.error("Functie 'initVECTRChart' is niet gevonden. Zorg ervoor dat deze globaal is gedefinieerd in vectr_chart.js.");
        }
    });
</script>
{% endblock %}