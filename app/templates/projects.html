{% extends "base.html" %}

{% block title %}Projects Overview{% endblock %}

{% block head %}
<style>
    body {
        background-color: #eaf4ff;
    }

    h2 {
        margin-top: 20px;
        margin-bottom: 20px;
        font-weight: 600;
    }

    .top-right-fixed {
        position: fixed;
        top: 15px;
        right: 20px;
        z-index: 999;
    }

    .project-wrapper {
        width: 90%;
        max-width: 1400px;
        margin: 40px auto;
        background: white;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }

    table {
        text-align: center;
    }

    .btn-sm {
        min-width: 90px;
    }

    .btn-edit {
        background-color: #c1429d;
        color: white;
    }
    .btn-edit:hover {
        background-color: #b33b91;
        color: white;
    }

    .btn-feature {
        background-color: #007bff;
        color: white;
    }

</style>
{% endblock %}

{% block content %}

<!-- FIXED DASHBOARD BUTTON -->
<div class="top-right-fixed">
    <a href="{{ url_for('main.dashboard') }}" class="btn btn-dark btn-sm">Go to Dashboard</a>
</div>

<h2>Projects Overview</h2>

<!-- Flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ 'danger' if category in ['danger','error'] else category }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="project-wrapper">
    <table class="table table-striped table-bordered align-middle">
        <thead class="table-light">
            <tr>
                <th>Project Name</th>
                <th>Company</th>
                <th style="width: 260px;">Actions</th>
                <th style="width: 220px;">Roadmap</th>
            </tr>
        </thead>

        <tbody>
        {% if projects|length == 0 %}
            <tr>
                <td colspan="4" class="text-muted py-4">No projects yet â€” add one soon!</td>
            </tr>
        {% else %}
            {% for project, company_name in projects %}
            <tr>
                <td>{{ project.project_name }}</td>
                <td>{{ company_name }}</td>

                <!-- ACTION BUTTONS -->
                <td>
                    <div class="d-flex justify-content-center gap-2">
                        <a href="{{ url_for('main.edit_project', project_id=project.id_project) }}" class="btn btn-edit btn-sm">Edit</a>
                        <a href="{{ url_for('main.delete_project', project_id=project.id_project) }}" class="btn btn-danger btn-sm">Delete</a>
                        <a href="{{ url_for('main.add_feature', project_id=project.id_project) }}" class="btn btn-primary btn-sm">Add Feature</a>
                    </div>
                </td>

                <!-- ROADMAP BUTTONS -->
                <td>
                    <div class="d-flex justify-content-center gap-2">
                        <a href="{{ url_for('main.roadmap_overview', project_id=project.id_project) }}" class="btn btn-primary btn-sm">View</a>
                        <a href="{{ url_for('main.add_roadmap', project_id=project.id_project) }}" class="btn btn-primary btn-sm">Add</a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        {% endif %}
        </tbody>
    </table>

    <div class="text-center mt-3">
        <a href="{{ url_for('main.add_project') }}" class="btn btn-primary">Add Project</a>
    </div>
</div>

{% endblock %}
