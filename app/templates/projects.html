{% extends "base.html" %}

{% block title %}Projects Overview{% endblock %}
{% block body_class %}projects-body{% endblock %}

{% block content %}
  <!-- FIXED DASHBOARD BUTTON -->
  <div class="top-right-fixed">
    <a href="{{ url_for('main.dashboard') }}" class="btn btn-base btn-nav btn-sm">Dashboard</a>
  </div>

  <!-- Titel + Add Project knop gecentreerd -->
  <h2 class="mb-4 text-center">Projects Overview</h2>

  <div class="mb-3 d-flex justify-content-center">
    <a href="{{ url_for('main.add_project') }}" class="btn btn-base btn-primary-custom">+ Add Project</a>
  </div>

  <div class="projects-wrapper">
    <table class="table table-striped table-bordered align-middle">
      <thead class="table-light">
        <tr>
          <th>Project Name</th>
          <th class="col-features">Features</th>
          <th class="col-roadmap">Roadmap</th>
          <th class="col-actions">Projects Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if projects|length == 0 %}
          <tr>
            <td colspan="5" class="text-muted py-4">No projects yet â€” add one soon!</td>
          </tr>
        {% else %}
          {% for project, company_name in projects %}
            <tr>
              <td>{{ project.project_name }}</td>

              <!-- FEATURES BUTTONS -->
              <td>
                <div class="d-flex justify-content-center gap-2">
                  <a href="{{ url_for('main.add_feature', project_id=project.id_project) }}" class="btn btn-base btn-primary-custom table-btn">Add</a>
                  <a href="{{ url_for('main.view_features', project_id=project.id_project) }}" class="btn btn-base btn-primary-custom table-btn">View</a>
                </div>
              </td>

              <!-- ROADMAP BUTTONS -->
              <td>
                {% set has_roadmap = project.roadmaps|length > 0 %}
                <div class="d-flex justify-content-center gap-2">
                  {% if has_roadmap %}
                    <a href="{{ url_for('main.roadmap_overview', project_id=project.id_project) }}" class="btn btn-base btn-primary-custom table-btn">View</a>
                  {% elif session['role'] == 'founder' %}
                    <a href="{{ url_for('main.create_roadmap', project_id=project.id_project) }}" class="btn btn-base btn-primary-custom table-btn">Create</a>
                  {% else %}
                    <span class="badge bg-secondary align-self-center">No roadmap</span>
                  {% endif %}
                </div>
              </td>

              <!-- ACTION BUTTONS -->
              <td>
                <div class="d-flex justify-content-center gap-2">
                  <a href="{{ url_for('main.edit_project', project_id=project.id_project) }}" class="btn btn-base btn-edit table-btn">Edit</a>
                  <form action="{{ url_for('main.delete_project', project_id=project.id_project) }}" method="post" class="form-inline">
                    <button type="submit" class="btn btn-base btn-danger-custom table-btn"
                            onclick="return confirm('Are you sure you want to delete this project?');">
                      Delete
                    </button>
                  </form>
                </div>
              </td>
            </tr>
          {% endfor %}
        {% endif %}
      </tbody>
    </table>
  </div>
{% endblock %}