{% extends "base.html" %}

{% block title %}Add Evidence{% endblock %}

{% block content %}

<div class="top-right-fixed">
  <a href="{{ url_for('main.view_features', project_id=feature.id_project) }}"
     class="btn btn-base btn-nav btn-sm">
    ← Back to Features
  </a>
</div>

<div class="bottom-info">
  Logged in as: <strong>{{ session['name'] }}</strong> |
  Role: <strong>{{ session['role'] }}</strong>
</div>

<h2 class="text-center mb-4">Add Evidence for: {{ feature.name_feature }}</h2>

<div class="card p-4 mx-auto" style="max-width: 700px;">
    <form method="POST">

        <!-- Title -->
        <div class="mb-3">
            <label class="form-label">Title</label>
            <input type="text" name="title" class="form-control" required>
        </div>

        <!-- Evidence Type -->
        <div class="mb-3">
            <label class="form-label">Evidence Type</label>
            <select id="evidence_type" name="type_select" class="form-select">
                <option value="Customer Feedback">Customer Feedback</option>
                <option value="Pilot Result">Pilot Result</option>
                <option value="Paying Customer">Paying Customer</option>
                <option value="Market Data">Market Data</option>
                <option value="Other">Other</option>
            </select>
        </div>

        <!-- Custom Evidence Type -->
        <div class="mb-3" id="custom_type_group" style="display: none;">
            <label class="form-label">Custom Evidence Type</label>
            <input type="text" name="custom_type" id="custom_type" class="form-control">
        </div>

        <!-- Source -->
        <div class="mb-3">
            <label class="form-label">Source</label>
            <input type="text" name="source" class="form-control" required>
        </div>

        <!-- Description -->
        <div class="mb-3">
            <label class="form-label">Description</label>
            <textarea name="description" class="form-control" rows="3" required></textarea>
        </div>

        <!-- Attachment -->
        <div class="mb-3">
            <label class="form-label">Attachment URL (PDF, link, etc.)</label>
            <input type="text" name="attachment_url" class="form-control">
        </div>

        <!-- NEW CONFIDENCE LEVEL -->
        <div class="mb-3">
            <label class="form-label">Confidence Level</label>
            <select name="new_confidence" class="form-select" required>
                <option value="">Select score</option>
                <option value="0.01">Self Conviction — 0.01</option>
                <option value="0.03">Pitch Deck — 0.03</option>
                <option value="0.1">Thematic Support — 0.10</option>
                <option value="0.2">Other’s Opinion — 0.20</option>
                <option value="0.5">Estimates & Plans — 0.50</option>
                <option value="1">Anecdotal Evidence — 1.0</option>
                <option value="2">Market Data — 2.0</option>
                <option value="3">User/Customer Evidence — 3.0</option>
                <option value="7">Test Results — 7.0</option>
                <option value="10">Launch Data — 10.0</option>
            </select>
        </div>

        <button class="btn btn-primary w-100">Add Evidence</button>
    </form>
</div>

<script>
document.getElementById("evidence_type").addEventListener("change", function () {
    const custom = document.getElementById("custom_type_group");
    if (this.value === "Other") {
        custom.style.display = "block";
    } else {
        custom.style.display = "none";
        document.getElementById("custom_type").value = "";
    }
});
</script>

{% endblock %}
